---
import { getCollection } from "astro:content";
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import CallToAction from "../../components/CallToAction.astro";

const entries = await getCollection("flashcards", ({ data }) => {
  return data.published;
});

const allTags = new Set<string>();
entries.forEach(entry => {
  entry.data.tags?.forEach(tag => allTags.add(tag));
});

const tags = Array.from(allTags).sort();
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead
      title="Flashcard Categories | Maik Hasler"
      description="Choose a category to study"
    />
  </head>
  <body class="flex flex-col min-h-screen bg-[#ece9f5]">
    <Header />
    <main class="min-h-screen grow w-full py-8 flex items-center">
      <div class="w-11/12 lg:w-8/12 mx-auto">
        <h1 class="text-4xl font-bold text-gray-800 mb-8 text-center">
          Choose a Category
        </h1>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
          {tags.map(tag => (
            <a
              href={`/flashcards/${encodeURIComponent(tag)}`}
              class="bg-white hover:bg-blue-50 p-6 rounded-xl shadow-sm border border-gray-200 transition-all hover:shadow-md hover:scale-105 flex items-center justify-between group"
            >
              <span class="text-lg font-semibold text-gray-800">
                {tag}
              </span>
              <svg
                class="w-5 h-5 text-gray-400 group-hover:text-blue-600 transition-colors"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </a>
          ))}
        </div>
        <div class="mt-8 text-center">
          <a
            href="/flashcards/all"
            class="inline-block bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition"
          >
            Study All Cards
          </a>
        </div>
      </div>
    </main>
    <CallToAction />
    <Footer />
  </body>
</html>
